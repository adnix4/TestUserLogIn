@page
@model TestUserLogIn.Pages.MemberInfoModel
@{
    ViewData["Title"] = "My Information";
}


<div class="card shadow-sm mb-4" id="introBlock">
    <div class="card-body">
        <h5>
            For you created my inner organs. You wove me together in my mother's womb.
            I praise you because I am fearfully and wonderfully made.
            Your works are wonderful, and my soul knows that very well.
        </h5>
        <h5 class="citedVerse">&minus; Psalm 139:13,14</h5>
    </div>
</div>

<h2 class="mb-4">Welcome, please verify or enter your profile information.</h2>


@if (Model.Roles.Any())
{
    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <h4 class="card-title">Registered Positions</h4>
            <ul class="list-group list-group-flush">
                @foreach (var role in Model.Roles)
                {
                    <li class="list-group-item">@role</li>
                }
            </ul>
        </div>
    </div>
}

@if (!ViewData.ModelState.IsValid)
{
    <div class="alert alert-danger">
        <strong>Please correct the following errors:</strong>
        <ul class="mb-0">
            @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
            {
                <li>@error.ErrorMessage</li>
            }
        </ul>
    </div>
}
<style>
    .required-asterisk {
        color: red;
        cursor: help;
        margin-left: 2px;
    }
</style>

<div class="card shadow-sm">
    <div class="card-body">
        <form method="post" id="memberForm" novalidate>
            <h4 class="card-title mb-3">Your Profile</h4>
            <p class="text-muted mb-4"><span class="text-danger">*</span> Indicates required fields.</p>

            <!-- Name -->
            <div class="row mb-3">
                <div class="col-md-6">
                    <label asp-for="MemberDetails.FirstName" class="form-label">
                        First Name
                        <span class="required-asterisk" title="This field is required">*</span>
                    </label>
                    <input asp-for="MemberDetails.FirstName" class="form-control" required />
                    <span asp-validation-for="MemberDetails.FirstName" class="text-danger"></span>
                </div>
                <div class="col-md-6">
                    <label asp-for="MemberDetails.LastName" class="form-label">
                        Last Name
                        <span class="required-asterisk" title="This field is required">*</span>
                    </label>
                    <input asp-for="MemberDetails.LastName" class="form-control" required />
                    <span asp-validation-for="MemberDetails.LastName" class="text-danger"></span>
                </div>
            </div>

            <!-- Email -->
            <div class="mb-3">
                <div class="col-md-6">
                    <label asp-for="MemberDetails.Email" class="form-label fw-semibold">
                        Email Address <span class="required-asterisk" title="Enter a valid email address">*</span>
                    </label>
                    <input asp-for="MemberDetails.Email" type="email" class="form-control" required />
                    <span asp-validation-for="MemberDetails.Email" class="text-danger"></span>
				</div>

                <div class="col-md-6">
                    <label asp-for="MemberDetails.PreferredContactEmail" class="form-label fw-semibold">
                        Preferred Contact Email
                    </label>
                    <input asp-for="MemberDetails.PreferredContactEmail" type="email" class="form-control" />
                    <div class="form-text">Optional — use if different from your login email.</div>
                </div>
            </div>

            <!-- Phone -->
            <div class="row mb-3">
                <div class="col-md-6">
                    <label asp-for="MemberDetails.CellPhoneNumber" class="form-label"></label>
                    <input asp-for="MemberDetails.CellPhoneNumber" class="form-control" pattern="^\+?\d{7,15}$" />
                    <span asp-validation-for="MemberDetails.CellPhoneNumber" class="text-danger"></span>
                </div>
                <div class="col-md-6">
                    <label asp-for="MemberDetails.HomePhoneNumber" class="form-label"></label>
                    <input asp-for="MemberDetails.HomePhoneNumber" class="form-control" pattern="^\+?\d{7,15}$" />
                    <span asp-validation-for="MemberDetails.HomePhoneNumber" class="text-danger"></span>
                </div>
            </div>

            <!-- Address -->
            <div class="mb-3">
                <label asp-for="MemberDetails.Address" class="form-label">Address</label>
                <input asp-for="MemberDetails.Address" class="form-control" />
            </div>

            <!-- City / State / Zip -->
            <div class="row mb-3">
                <div class="col-md-4">
                    <label asp-for="MemberDetails.City" class="form-label">City</label>
                    <input asp-for="MemberDetails.City" class="form-control" />
                </div>
                <div class="col-md-4">
                    <label asp-for="MemberDetails.State" class="form-label">State</label>
                    <input asp-for="MemberDetails.State" class="form-control" />
                </div>
                <div class="col-md-4">
                    <label asp-for="MemberDetails.Zip" class="form-label">Zip Code</label>
                    <input asp-for="MemberDetails.Zip" class="form-control" />
                </div>
            </div>

            <!-- Birthdate / Sex -->
            <div class="row mb-3">
                <div class="col-md-6">
                    <label asp-for="MemberDetails.BirthDate" class="form-label"></label>
                    <input asp-for="MemberDetails.BirthDate" type="date" class="form-control" max="@DateTime.Today.ToString("yyyy-MM-dd")" />
                    <span asp-validation-for="MemberDetails.BirthDate" class="text-danger"></span>
                </div>
                <div class="col-md-6">
                    <label asp-for="MemberDetails.Sex" class="form-label">Gender</label>
                    <select asp-for="MemberDetails.Sex" class="form-select">
                        <option value="">-- Select --</option>
                        <option>Male</option>
                        <option>Female</option>
                        
                    </select>
                </div>
            </div>

            <!-- Contact Preferences -->
            <div class="mb-3">
                <label class="form-label fw-semibold">Preferred Contact Methods</label>
                <div class="form-check">
                    <input class="form-check-input" asp-for="MemberDetails.PrefersPhone" type="checkbox" id="prefPhone" />
                    <label class="form-check-label" for="prefPhone">Phone Call</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" asp-for="MemberDetails.PrefersText" type="checkbox" id="prefText" />
                    <label class="form-check-label" for="prefText">Text Message</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" asp-for="MemberDetails.PrefersEmail" type="checkbox" id="prefEmail" />
                    <label class="form-check-label" for="prefEmail">Email</label>
                </div>
            </div>

            <!-- Comments -->
            <div class="mb-3">
                <label asp-for="MemberDetails.Comments" class="form-label">Comments</label>
                <textarea asp-for="MemberDetails.Comments" class="form-control" rows="3"></textarea>
            </div>

            <button type="submit" class="btn btn-primary">
                <i class="bi bi-save"></i> Select Interests
            </button>
        </form>
    </div>
</div>

<!-- Bootstrap Toast for Validation -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="validationToast" class="toast align-items-center text-bg-danger border-0" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body fw-semibold">
                ⚠️ Please fill out all required fields before continuing.
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.getElementById('memberForm').addEventListener('submit', function (event) {
            const form = event.target;
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();

                // Show Bootstrap toast
                const toast = new bootstrap.Toast(document.getElementById('validationToast'));
                toast.show();

                // Add Bootstrap validation styling
                form.classList.add('was-validated');
            }
        }, false);
    </script>
}
